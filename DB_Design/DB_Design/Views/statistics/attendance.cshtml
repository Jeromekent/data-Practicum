@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
    var att = ViewData["att"] as List<AttendanceStatistic>;
    var dep = ViewData["dep"] as List<Department>;
}
    <head>
        <script type="text/javascript">
        //function search(did) {
        //    var xmlhttp;
        
        //        if (window.XMLHttpRequest) {// code for IE7+, Firefox, Chrome, Opera, Safari
        //            xmlhttp = new XMLHttpRequest();
        //        }
        //        else {// code for IE6, IE5
        //            xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
        //        }

        //        xmlhttp.onreadystatechange = function () {
        //            if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
        //                alert("   ");
        //            }
        //        }

        //        xmlhttp.open("Post", "/statistics/attendance", true);
        //        xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
        //        xmlhttp.send("&id="+did);
        //}
        </script>
    </head>

<div>
    <div class="panel-title">
        <h1 class="text-center">出勤统计</h1>
        <span>统计：@ViewBag.name</span>
    </div>
    <div >
        <table class="table table-striped table-bordered table-hover dataTable no-footer" id="dataTables-example" aria-describedby="dataTables-example_info">
            <tbody >
                @for(int j = 0; j < dep.Count; j++)
                {
                <tr class="gradeA even">
                    <td>@dep[j].DId</td>
                    <td>@dep[j].DName</td>
                    <td>
                        <a type="button" href="@Url.Action("attendance","statistics")?id=@dep[j].DId" class="btn btn-success">选择该部门</a>
                    </td>
                    @if (j + 1 < dep.Count)
                    {
                        <td>@dep[++j].DId</td>
                        <td>@dep[j].DName</td>
                        <td>
                            <a type="button" href ="@Url.Action("attendance","statistics")?id=@dep[j].DId" class="btn btn-success">选择该部门</a>
                        </td>
                    }

                </tr>
                }
            </tbody>
        </table>
    </div>
    <div class="panel-body">
        <div class="table-responsive">
            <div id="div">
                <table class="table table-striped table-bordered table-hover dataTable no-footer" id="dataTables-example" aria-describedby="dataTables-example_info">
                    <thead>
                        <tr role="row">
                            <th class="sorting_asc text-center" tabindex="0" aria-controls="dataTables-example" rowspan="1" colspan="1" aria-sort="ascending" aria-label="Rendering engine: activate to sort column ascending" style="width: 211px;">
                                工号
                            </th>
                            <th class="sorting text-center" tabindex="0" aria-controls="dataTables" rowspan="1" colspan="1" aria-label="Browser: activate to sort column ascending" style="width: 288px;">
                                姓名
                            </th>
                            <th class="sorting text-center" tabindex="0" aria-controls="dataTables-example" rowspan="1" colspan="1" aria-label="Platform(s): activate to sort column ascending" style="width: 267px;">
                                年
                            </th>
                            <th class="sorting text-center" tabindex="0" aria-controls="dataTables-example" rowspan="1" colspan="1" aria-label="Engine version: activate to sort column ascending" style="width: 183px;">
                                月
                            </th>
                            <th class="sorting text-center" tabindex="0" aria-controls="dataTables-example" rowspan="1" colspan="1" aria-label="CSS grade: activate to sort column ascending" style="width: 136px;">
                                迟到次数
                            </th>
                            <th class="sorting text-center" tabindex="0" aria-controls="dataTables-example" rowspan="1" colspan="1" aria-label="CSS grade: activate to sort column ascending" style="width: 136px;">
                                早退次数
                            </th>
                            <th class="sorting text-center" tabindex="0" aria-controls="dataTables-example" rowspan="1" colspan="1" aria-label="CSS grade: activate to sort column ascending" style="width: 136px;">
                                旷工次数
                            </th>
                            <th class="sorting text-center" tabindex="0" aria-controls="dataTables-example" rowspan="1" colspan="1" aria-label="CSS grade: activate to sort column ascending" style="width: 136px;">
                                正常次数
                            </th>
                        </tr>
                    </thead>
                    <tbody id="mytable">
                        @for (int i = 0; i < att.Count; i++)
                        {
                            <tr class="gradeA even">
                                <td class="sorting_1">@att[i].Id</td>
                                <td class="center ">@att[i].Name</td>
                                <td class="center ">@att[i].Year</td>
                                <td class="center ">@att[i].Month</td>
                                <td class="center ">@att[i].LateTimes</td>
                                <td class="center ">@att[i].LeaveEarlyTimes</td>
                                <td class="center ">@att[i].AbsenteeismTimes</td>
                                <td class="center ">@att[i].NormalTimes</td>
                            </tr>
                        }

                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>